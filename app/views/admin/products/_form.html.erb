<%= simple_nested_form_for([:admin, @product], html: {class: 'form-horizontal', multipart: true}) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :name, input_html: {class: 'span12'} %>
    <%= f.input :slug, input_html: {class: 'span12'} %>
    <%= f.input :public, as: :radio_buttons, item_wrapper_class: 'inline' %>
    <%= f.input :price, input_html: {class: 'input-small'} %>
    <%= f.input :sale_price, input_html: {class: 'input-small'} %>
    <%= f.input :in_stock, input_html: {class: 'input-small'} %>

    <div class="control-group" style="position:relative;">
      <label class="string required control-label" for="article_control">Description <abbr title="requis">*</abbr></label>
      <div class="controls">
        <a href="#" class="go-zen"><i class="s s--zen">Edit in Zen Mode</i></a>
        <%= f.text_area :description, class: "zen-mode", "data-label"=>"Ã‰crire ici..." %>
      </div>
    </div>
  </div>
  
  <h3 class="subsection_title">Classification & Related Products</h3>
  <div class="control-group">
    <label class="control-label" for="product_category_tokens">Categories</label>
    <div class="controls" style="position:absolute;">
      <%= f.text_field :category_tokens, data: {load: @product.categories} %>
    </div>
  </div>

  <div class="control-group">
    <label class="control-label" for="product_supplier_tokens">Vendor</label>
    <div class="controls" style="position:absolute;">
      <%= f.text_field :supplier_tokens, data: {load: @product.suppliers} %>
    </div>
  </div>

  <div class="control-group">
    <label class="control-label" for="product_cross_sell_tokens">Cross-Sell Products</label>
    <div class="controls" style="position:absolute;">
      <%= f.text_field :cross_sell_tokens, data: {load: @product.cross_sell_products} %>
    </div>
  </div>
  
  <h3 class="subsection_title">Options</h3>
  <div class="control-group">
    <div class="controls">
      <label class="checkbox">
        <%= f.check_box :has_options %> This product has multiple options e.g. Multiple sizes and/or colors
      </label>
    </div>
  </div>

  <div class="control-group" id="options-container" style="display: <%= @product.has_options? ? 'block' : 'none' %>;">
    <div class="controls well">
      <table class="table" id="options_fields">
        <tr>
          <th class="span3">OPTION NAME</th>
          <th class="span8">OPTION VALUES</th>
          <th></th>
        </tr>
        <%= f.fields_for :options, wrapper: false do |ff| %>
          <tr>
            <td><%= ff.input_field :name, collection: ['color', 'size', 'style', 'material'], include_blank: false %></td>
            <td><%= ff.text_field :values, class: "span12", placeholder: "Enter any options separated by a comma" %></td>
            <td><%= ff.link_to_remove "#{t 'remove'}", data: {wrapper: 'tr'} %></td>
          </tr>
        <% end %>
      </table>
      <%= f.link_to_add t('products.add_another_option'), :options, class: "btn" %>
    </div>
  </div>
  
  <h3 class="subsection_title">SEO</h3>
  <% @product.build_meta_tag unless @product.meta_tag %>
  <%= f.fields_for :meta_tag do |meta| %>
    <%= meta.input :title, input_html: {class: "span12"}, placeholder: "up to 70 characters and 10 words" %>
    <%= meta.input :description, input_html: {class: "span12 rows2"}, placeholder: "up to 160 characters" %>
  <% end %>

  <h3 class="subsection_title">Variants</h3>
  <%= f.fields_for :variants do |v| %>
    <%= content_tag_for :div, v.object do %>
      <%= v.input :name, placeholder: "Small, Blue, Large...", input_html: {class: 'span5'} %>
      <%= v.input :price, input_html: {class: 'input-small'} %>
      <%= v.input :in_stock, input_html: {class: 'input-small'} %>
      <i class="icon-remove"></i> <%= v.link_to_remove "#{t 'remove'}" %>
      <hr>
    <% end %>
  <% end %>
  <%= f.link_to_add t('products.add_new_variant'), :variants, class: "btn btn-info" %>

  <div class="form-actions">
    <%= submit_or_cancel(f) %>
  </div>
<% end %>

<script type="text/javascript">
$(function() {
  $('#product_has_options').click(function() {
    if ($(this).is(':checked')) {
      $('#options-container').show();
    } else {
      $('#options-container').hide();
    }
  });
});
</script>